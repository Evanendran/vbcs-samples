{
  "pageModelVersion": "0.9.7",
  "description": "REST example",
  "variables": {
    "personId": {
      "type": "string",
      "input": "fromUrl",
      "required": true
    },
    "person": {
      "type": "application:person"
    },
    "companyPickListValues": {
      "type": [
        {
          "value": "number",
          "label": "string"
        }
      ]
    }
 },
  "chains": {
    "loadPerson": {
      "variables": {},
      "root": "restGetPerson",
      "actions": {
        "restGetPerson": {
          "module": "vb/action/builtin/restAction",
          "parameters": {
            "endpoint": "person/get_Person",
            "uriParams": {
              "Person-Id": "{{ $page.variables.personId }}"
            }
          },
          "outcomes": {
            "success": "setPerson"
          }
        },
        "setPerson": {
          "module": "vb/action/builtin/assignVariablesAction",
          "parameters": {
            "$page.variables.person": {
              "source": "{{ $chain.results.restGetPerson.body }}"
            }
          }
        }
      }
    },
    "loadCompanyListPickList": {
      "root": "restGetCompanies",
      "actions": {
        "restGetCompanies": {
          "module": "vb/action/builtin/restAction",
          "parameters": {
            "endpoint": "company/getall_Company"
          },
          "outcomes": {
            "success": "setCompanyPickListValues"
          }
        },
        "setCompanyPickListValues": {
          "module": "vb/action/builtin/assignVariablesAction",
          "parameters": {
            "$page.variables.companyPickListValues": {
              "source": "{{ $chain.results.restGetCompanies.body.items }}",
              "mapping": {
                "$target.label": "$source.name",
                "$target.value": "$source.id"
              }
            }
          }
        }
      }
    },
    "savePerson": {
      "root": "saveIncident",
      "actions": {
        "saveIncident": {
          "module": "vb/action/builtin/restAction",
          "parameters": {
            "endpoint": "person/update_Person",
            "uriParams": {
              "Person-Id": "{{ $page.variables.personId }}"
            },
            "body": "{{ $page.variables.person }}"
          },
          "outcomes": {
            "success": "navigateBack"
          }
        },
        "navigateBack": {
          "module": "vb/action/builtin/navigateBackAction"
        }
      }
    },
    "navigateBack": {
      "root": "navigateBack",
      "actions": {
        "navigateBack": {
          "module": "vb/action/builtin/navigateBackAction"
        }
      }
    }
  },
  "eventListeners": {
    "vbEnter": {
      "chains": [
        {
          "chainId": "loadPerson"
        },
        {
          "chainId": "loadCompanyListPickList"
        }
      ]
    },
    "onSaveButtonClick": {
      "chains": [
        {
          "chainId": "savePerson",
          "parameters": {}
        }
      ]
    },
    "onCancelButtonClick": {
      "chains": [
        {
          "chainId": "navigateBack",
          "parameters": {}
        }
      ]
    }
  }
}