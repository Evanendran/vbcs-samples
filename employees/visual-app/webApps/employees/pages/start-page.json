{
  "pageModelVersion": "0.9.7",
  "title": "REST Example",
  "description": "REST example",
  "variables": {
    "personList": {
      "type": "vb/ServiceDataProvider",
      "input": "none",
      "defaultValue": {
        "endpoint": "EmployeeService/getall_Person",
        "idAttribute": "id",
        "itemsPath": "items",
        "fetchChainId": "fetchPeopleListChain"
      }
    },
    "newPerson": {
      "type": "application:person"
    }
  },
  "chains": {
    "fetchPeopleListChain": {
      "variables": {
        "configuration": {
          "type": {
            "hookHandler": "vb/RestHookHandler"
          },
          "description": "the configuration for the rest action",
          "input": "fromCaller",
          "required": true
        },
        "response": {
          "type": "object"
        }
      },
      "root": "fetchPeopleList",
      "actions": {
        "fetchPeopleList": {
          "module": "vb/action/builtin/restAction",
          "parameters": {
            "endpoint": "EmployeeService/getall_Person",
            "hookHandler": "{{ $variables.configuration.hookHandler }}"
          },
          "outcomes": {
            "success": "returnSuccessResponse",
            "failure": "returnFailureResponse"
          }
        },
        "returnSuccessResponse": {
          "module": "vb/action/builtin/returnAction",
          "parameters": {
            "outcome": "success",
            "payload": "{{ $chain.results.fetchPeopleList }}"
          }
        },
        "returnFailureResponse": {
          "module": "vb/action/builtin/returnAction",
          "parameters": {
            "outcome": "failure",
            "payload": "{{ $chain.results.fetchPeopleList }}"
          }
        }
      }
    },
    "navigateToPerson": {
      "variables": {
        "personId": {
          "type": "string",
          "description": "The person id to navigate to",
          "input": "fromCaller",
          "required": true
        }
      },
      "root": "navigateToPage",
      "actions": {
        "navigateToPage": {
          "module": "vb/action/builtin/navigateToPageAction",
          "parameters": {
            "page": "detail",
            "params": {
              "personId": "{{ $variables.personId }}"
            }
          }
        }
      }
    },
    "createPerson": {
      "root": "createPersonPost",
      "actions": {
        "createPersonPost": {
          "module": "vb/action/builtin/restAction",
          "parameters": {
            "endpoint": "EmployeeService/create_Person",
            "body": "{{ $page.variables.newPerson }}"
          },
          "outcomes": {
            "success": "updateList"
          }
        },
        "updateList": {
          "module": "vb/action/builtin/fireDataProviderEventAction",
          "parameters": {
            "target": "{{ $page.variables.personList }}",
            "refresh": null
          }
        }
      }
    }
  },
  "eventListeners": {
    "onSelectPerson": {
      "chains": [
        {
          "chainId": "navigateToPerson",
          "parameters": {
            "personId": "{{ $event.detail.value[0] }}"
          }
        }
      ]
    },
    "onCreateButtonClick": {
      "chains": [
        {
          "chainId": "createPerson",
          "parameters": {
            "personId": "{{ $event.detail.value[0] }}"
          }
        }
      ]
    }
  }
}
